<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <title>Blog</title>

    <!-- Bootstrap -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha384-HSMxcRTRxnN+Bdg0JdbxYKrThecOKuH5zCYotlSAcp1+c8xmyTe9GYg1l9a69psu" crossorigin="anonymous">
    <link rel="stylesheet" href="css/custom.css" />
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <style>
        .navbar-brand {
            padding: 5px;
        }
    </style>
</head>
<nav class="navbar navbar-inverse bg-dark">
    <div class="container">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"><span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
            <a class="navbar-brand" href="#"> <img alt="Brand" src="images/logo.png" width="50px">
            </a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav">
                <li><a href="home.html">Home</a></li>
                <li class="active"><a href="blogs.html">Blog <span class="sr-only">(current)</span></a></li>
                <li><a href="profile.html">About</a></li>
                <li><a href="contact.html">Contact Us</a></li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
                <li><a href="#"><span class="glyphicon glyphicon-user"></span>Akshay </a></li>
            </ul>
            <form class="navbar-form navbar-right">
                <div class="form-group">
                    <input type="text" class="form-control" placeholder="Search">
                </div>
                <button type="submit" class="btn btn-default">Submit</button>
            </form>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container-fluid -->
</nav>

<body>
    <div class="container">
        <img class="media-object float-right" style='height: 100px; width: 100px;  object-fit: contain' src="images/aws.png">
        <h1 class="lb-h2 blog-post-title" property="name headline">Automated Response and Remediation with AWS Security Hub</h1>
        <span property="author" typeof="Person"><span property="name">Jonathan Rau</span></span>
        |
        <time property="datePublished" datetime="2020-01-29T11:13:18-07:00">29 JAN 2020</time>
        <section class="blog-content">
            <p><a href="https://aws.amazon.com/security-hub/features/" target="_blank" rel="noopener noreferrer">AWS Security Hub</a> is a service that gives you aggregated visibility into your security and compliance status across multiple AWS accounts.
                In addition to consuming findings from Amazon services and integrated partners, Security Hub gives you the option to <a href="https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-cloudwatch-events.html#securityhub-cwe-configure"
                    target="_blank" rel="noopener noreferrer">create custom actions, which allow a customer to manually invoke a specific response or remediation action on a specific finding</a>. You can send custom actions to <a href="https://docs.aws.amazon.com/AmazonCloudWatch/latest/events/WhatIsCloudWatchEvents.html"
                    target="_blank" rel="noopener noreferrer">Amazon CloudWatch Events</a> as a specific <a href="https://docs.aws.amazon.com/AmazonCloudWatch/latest/events/CloudWatchEventsandEventPatterns.html" target="_blank" rel="noopener noreferrer">event pattern</a>,
                allowing you to create a CloudWatch Events <a href="https://docs.aws.amazon.com/AmazonCloudWatch/latest/events/Create-CloudWatch-Events-Rule.html" target="_blank" rel="noopener noreferrer">rule</a> that listens for these actions and sends
                them to a target service, such as a <a href="https://aws.amazon.com/lambda/" target="_blank" rel="noopener noreferrer">Lambda function</a> or <a href="https://aws.amazon.com/sqs/" target="_blank" rel="noopener noreferrer">Amazon SQS queue</a>.</p>
            <p>By creating custom actions mapped to specific finding type and by developing a corresponding Lambda function for that custom action, you can achieve targeted, automated remediation for these findings. This allows a customer to specifically
                decide if he or she wants to invoke a remediation action on a specific finding. A customer can also use these Lambda functions as the target of fully automated remediation actions that do not require any human review.</p>
            <p>In this blog post, I’ll show you how to build custom actions, CloudWatch Event rules, and Lambda functions for a dozen targeted actions that can help you remediate <a href="https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards.html"
                    target="_blank" rel="noopener noreferrer">CIS AWS Foundations Benchmark</a>-related compliance findings. I’ll also cover use cases for sending findings to an issue management system and for automating security patching. To promote rapid
                deployment and adoption of this solution, you’ll deploy a majority of the necessary components via <a href="https://aws.amazon.com/cloudformation/" target="_blank" rel="noopener noreferrer">AWS CloudFormation</a>.</p>
            <p><strong>Note</strong>: The <a href="https://github.com/aws-samples/aws-security-hub-response-and-remediation" target="_blank" rel="noopener noreferrer">full repository</a> for current and future response and remediation templates is hosted
                on GitHub and includes additional technical guidance for expanding the solution provided in this post.</p>
            <h3>Solution Architecture</h3>
            <div id="attachment_12404" style="width: 810px" class="wp-caption aligncenter">
                <img aria-describedby="caption-attachment-12404" class="size-full wp-image-12404" src="https://d2908q01vomqb2.cloudfront.net/22d200f8670dbdb3e253a90eee5098477c95c23d/2020/01/25/SOARToday-figure-01.png" alt="Figure 1 - Solution Architecture Overview" width="800"
                    height="235">
                <p id="caption-attachment-12404" class="wp-caption-text">Figure 1 – Solution Architecture Overview</p>
            </div>
            <ol>
                <li>Integrated services send their findings to Security Hub.</li>
                <li>From the Security Hub console, you’ll choose a custom action for a finding. Each custom action is then emitted as a CloudWatch Event.</li>
                <li>The CloudWatch Event rule triggers a Lambda function. This function is mapped to a custom action based on the custom action’s ARN.</li>
                <li>Dependent on the particular rule, the Lambda function that is invoked will perform a remediation action on your behalf.</li>
            </ol>
            <p>For the purpose of this blog post, I’ll refer to the end-to-end combination of a custom action, a CloudWatch Event rule, a Lambda function, plus any supporting services needed to perform a specific action as a “playbook.” To demonstrate how
                a remediation solution works end-to-end, I’ll show you how to build your first playbook manually. You’ll deploy the remainder of the playbooks via CloudFormation.</p>
            <p>I’ll also show you how to modify four of the playbooks (three of which are appended by an asterisk), as they use AWS Lambda <a href="https://docs.aws.amazon.com/lambda/latest/dg/env_variables.html" target="_blank" rel="noopener noreferrer">environment variables</a>                to perform their actions, we’ll walk through populating these later.</p>
            <p>Based on feedback from Security Hub customers, the following controls from the CIS AWS Foundations Benchmark will be supported by this blog post:</p>
            <ul>
                <li><a href="https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-cis-controls.html#securityhub-cis-controls-1.3" target="_blank" rel="noopener noreferrer">1.3</a> – “Ensure credentials unused for 90 days or greater are disabled”</li>
                <li><a href="https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-cis-controls.html#securityhub-cis-controls-1.4" target="_blank" rel="noopener noreferrer">1.4</a> – “Ensure access keys are rotated every 90 days or less”</li>
                <li><a href="https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-cis-controls.html#securityhub-cis-controls-1.5" target="_blank" rel="noopener noreferrer">1.5</a> – “Ensure IAM password policy requires at least one uppercase
                    letter”
                </li>
                <li><a href="https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-cis-controls.html#securityhub-cis-controls-1.6" target="_blank" rel="noopener noreferrer">1.6</a> – “Ensure IAM password policy requires at least one lowercase
                    letter”
                </li>
                <li><a href="https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-cis-controls.html#securityhub-cis-controls-1.7" target="_blank" rel="noopener noreferrer">1.7</a> – “Ensure IAM password policy requires at least one symbol”</li>
                <li><a href="https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-cis-controls.html#securityhub-cis-controls-1.8" target="_blank" rel="noopener noreferrer">1.8</a> – “Ensure IAM password policy requires at least one number”</li>
                <li><a href="https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-cis-controls.html#securityhub-cis-controls-1.9" target="_blank" rel="noopener noreferrer">1.9</a> – “Ensure IAM password policy requires a minimum length of
                    14 or greater”</li>
                <li><a href="https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-cis-controls.html#securityhub-cis-controls-1.10" target="_blank" rel="noopener noreferrer">1.10</a> – “Ensure IAM password policy prevents password reuse”</li>
                <li><a href="https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-cis-controls.html#securityhub-cis-controls-1.11" target="_blank" rel="noopener noreferrer">1.11</a> – “Ensure IAM password policy expires passwords within 90
                    days or less”</li>
                <li><a href="https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-cis-controls.html#securityhub-cis-controls-2.2" target="_blank" rel="noopener noreferrer">2.2</a> – “Ensure CloudTrail log file validation is enabled”</li>
                <li><a href="https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-cis-controls.html#securityhub-cis-controls-2.3" target="_blank" rel="noopener noreferrer">2.3</a> – “Ensure the S3 bucket CloudTrail logs to is not publicly
                    accessible”
                </li>
                <li><a href="https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-cis-controls.html#securityhub-cis-controls-2.4" target="_blank" rel="noopener noreferrer">2.4</a> – “Ensure CloudTrail trails are integrated with Amazon CloudWatch
                    Logs”*
                </li>
                <li><a href="https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-cis-controls.html#securityhub-cis-controls-2.6" target="_blank" rel="noopener noreferrer">2.6</a> – “Ensure S3 bucket access logging is enabled on the CloudTrail
                    S3 bucket”*</li>
                <li><a href="https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-cis-controls.html#securityhub-cis-controls-2.7" target="_blank" rel="noopener noreferrer">2.7</a> – “Ensure CloudTrail logs are encrypted at rest using AWS KMS
                    CMKs”
                </li>
                <li><a href="https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-cis-controls.html#securityhub-cis-controls-2.8" target="_blank" rel="noopener noreferrer">2.8</a> – “Ensure rotation for customer created CMKs is enabled”</li>
                <li><a href="https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-cis-controls.html#securityhub-cis-controls-2.9" target="_blank" rel="noopener noreferrer">2.9</a> – “Ensure VPC flow logging is enabled in all VPCs”*</li>
                <li><a href="https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-cis-controls.html#securityhub-cis-controls-4.1" target="_blank" rel="noopener noreferrer">4.1</a> – “Ensure no security groups allow ingress from 0.0.0.0/0 to
                    port 22”</li>
                <li><a href="https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-cis-controls.html#securityhub-cis-controls-4.2" target="_blank" rel="noopener noreferrer">4.2</a> – “Ensure no security groups allow ingress from 0.0.0.0/0 to
                    port 3389”</li>
                <li><a href="https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-cis-controls.html#securityhub-cis-controls-4.3" target="_blank" rel="noopener noreferrer">4.3</a> – “Ensure the default security group of every VPC restricts
                    all traffic”</li>
            </ul>
            <p>You’ll also deploy and modify an additional playbook, “Send findings to JIRA.” You can find the high-level description of each playbook in each custom action creation script, as well as in the CloudFormation resource descriptions.</p>
            <p><strong>Note</strong>: If you want to send Security Hub findings to a security information and event management tool (SIEM) such as <a href="https://aws.amazon.com/elasticsearch-service/" target="_blank" rel="noopener noreferrer">Amazon ElasticSearch Service</a>                or a third-party solution, you must change the CloudWatch Events event pattern to <a href="https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-cloudwatch-events.html#securityhub-cwe-all-findings" target="_blank" rel="noopener noreferrer">match all findings</a>                and use different targets such as <a href="https://aws.amazon.com/kinesis/data-streams/?nc=sn&amp;loc=2&amp;dn=2" target="_blank" rel="noopener noreferrer">Amazon Kinesis Data Streams</a> to <a href="https://docs.aws.amazon.com/elasticsearch-service/latest/developerguide/es-aws-integrations.html#es-aws-integrations-fh"
                    target="_blank" rel="noopener noreferrer">Kinesis Data Firehose</a> to load your SIEM. This process is out of scope for this post.</p>
        </section>

    </div>






    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://code.jquery.com/jquery-1.12.4.min.js" integrity="sha384-nvAa0+6Qg9clwYCGGPpDQLVpLNn0fRaROjHqs13t4Ggj3Ez50XnGQqc/r8MhnRDZ" crossorigin="anonymous"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha384-aJ21OjlMXNL5UyIl/XNwTMqvzeRMZH2w8c5cRVpzpU8Y5bApTppSuUkhZXN0VxHd" crossorigin="anonymous"></script>
</body>
<!-- Footer -->
<footer class="page-footer font-small blue">

    <!-- Copyright -->
    <div class="footer-copyright text-center py-3">© 2020 Copyright:
        <a href="https://tcs.com/"> tcs.com</a>
    </div>
    <!-- Copyright -->

</footer>
<!-- Footer -->

</html>